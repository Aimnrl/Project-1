"""
Utility functions for preprocessing and feature engineering.
"""
import pandas as pd
import numpy as np
import isodate

def parse_iso_duration(dur):
    """
    Parses an ISO 8601 duration string (e.g., 'PT5M30S') into total seconds.
    """
    if pd.isna(dur):
        return np.nan
    try:
        td = isodate.parse_duration(dur)
        return td.total_seconds()
    except Exception:
        return np.nan
